# Chapter 04

### 코드 기반 단위 테스트

함수의 커버리지 비율을 측정해 로직의 확실성을 확인하는 **화이트박스 테스트**

- 프로그램을 실행하는 도중, 시스템상의 이상 작동을 수행하지 않음
- 입력값과 그에 대응하는 기댓값을 출력함
- 모든 분기가 올바르게 처리됨 (경곗값 테스트)

### 명령 커버리지(C0 커버리지)와 조건 커버리지(C1 커버리지)

명령 커버리지(테스트 포괄설 수준)

- 테스트에서 적어도 한 번은 프로그램의 모든 명령문을 실행한다.
- 모든 명령문(조건을 의미하는 거 같음)을 실행한다면 조건 분기를 타지 않는 케이스는 테스트가 누락됨
- 이 때문에 명령 커버리지는 불완전 테스트라고 알려짐
- 그렇기에 확실한 조건 커버리지를 달성할 것을 권장

조건 커버리지

- 방법: 각각의 판정 조검이 true, false인 결과를 적어도 1번씩 가지는 테스트

```
if(con1 == 0){
  x = x + 1;
}

if(conf2 > 1){
  x = x * 2
}

```

위와 같은 분기를 가질 때, 조건 커버리지는 두 가지의 테스트 케이스를 가질 수 있음

- con1 = 0, con2 = 2
- con1 = 1, con2 = 0

[true, false], [false, true] 케이스만 테스트 해도 괜찮은가?
-> 위에서는 같은 변수가 두 개의 조건을 탔기 때문인 것 같음

**단위 테스트의 목적**

- 단위 수준에서의 처리 기능의 버그를 없애는 것
- 입력값의 패턴을 100% 커버하고, 그에 대한 기대 처리가 올바른지를 체크하는 것
- 커버리지가 높다고 좋은 테스트가 아님(조건 커버리지에 주력해야 함)

**TDD(테스트 주도 개발) 진행 단계**

1. 레드: 항상 실패하는 테스트 작성
2. 그린: 테스트를 통과할 정도의 최소한의 프로덕션 코드를 작성
3. 리팩터: 테스트가 통과하면 프로덕션 코드를 리팩터링

### 커버리지 비율

- 소프트웨어라면 80% 커버하면 됨
- 소스코드의 20%는 에러 핸들링 처리
- 에러 핸들링 코드까지 단위 테스트로 커버할 필요 없음
  - 그렇다면 에러 핸들링 코드 제외하고 전부 다 단위 테스트를 진행해야 하는가

**구글의 코드 커버리지 내부 가이드 라인**

- 커버리지 60%: 허용 범위
- 커버리지 75%: 권장
- 커버리지 90%: 모범적
- 낮은 코드 커버리지는 넓은 코드 영역이 테스트되어 있지 않음을 보증
- 높은 코드 커버리지라고 해서 품질이 높은 것은 아님(돌연변이 테스트를 사용하는 것도 방법)
  - 돌연변이 테스트는 무엇인가?
- 자주 업데이트되는 코드는 커버해야 함
- 레거시 코드라도 조금씩 커버리지 비율을 높여가는 것이 좋음
